# Test Dockerfile - includes dev dependencies
FROM python:3.12-slim

WORKDIR /app

# Install uv for fast package management
RUN pip install uv

# Copy dependency files
COPY requirements.txt pyproject.toml ./

# Create virtual environment and install dependencies including dev
RUN uv venv /app/.venv && \
    . /app/.venv/bin/activate && \
    uv pip install -r requirements.txt

# Copy application code
COPY src/ ./src/
COPY main.py .
COPY tests/ ./tests/

# Set environment variables
ENV PATH="/app/.venv/bin:$PATH"
ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1

# Default command - run tests
CMD ["pytest", "tests/", "-v"]
